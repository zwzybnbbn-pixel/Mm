<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø·ÙˆØ§Ø±Ø¦</title>

<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;800&display=swap" rel="stylesheet">

<style>

  * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Cairo', sans-serif; }

  body {
    background: #f1f1f1;
    padding: 15px;
  }

  h1 {
    text-align: center;
    color: #00695C;
    margin-bottom: 20px;
    font-size: 28px;
    font-weight: 800;
  }

  .loading {
    text-align: center;
    font-size: 20px;
    color: #00796B;
    margin-bottom: 20px;
    font-weight: 700;
  }

  .grid {
    display: grid;
    grid-template-columns: 1fr;
    gap: 18px;
  }

  @media (min-width: 600px) {
    .grid {
      grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
    }
  }

  .card {
    background: white;
    border-radius: 14px;
    box-shadow: 0 3px 12px #00000020;
    padding: 18px;
    transition: .25s;
  }

  .card:hover {
    transform: translateY(-6px);
    box-shadow: 0 10px 25px #00000030;
  }

  .map-img {
    width: 100%;
    height: 160px;
    border-radius: 12px;
    object-fit: cover;
    margin-bottom: 12px;
  }

  .card h3 {
    font-size: 22px;
    color: #004D40;
    font-weight: 700;
    margin-bottom: 6px;
  }

  .card p {
    font-size: 16px;
    color: #555;
    margin-bottom: 6px;
  }

  .btn {
    display: block;
    margin-top: 12px;
    text-decoration: none;
    padding: 10px;
    text-align: center;
    background: #00796B;
    color: white;
    border-radius: 10px;
    font-size: 16px;
  }

</style>
</head>

<body>

<h1>Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø·ÙˆØ§Ø±Ø¦</h1>

<!-- Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„ -->
<div id="loading" class="loading">â³ Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...</div>

<div id="emergencyBox" class="grid"></div>

<script type="module">

import { db } from "./firebase-config.js";
import { collection, getDocs } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-firestore.js";

const box = document.getElementById("emergencyBox");
const loading = document.getElementById("loading");

// ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø·ÙˆØ§Ø±Ø¦
async function loadEmergency() {

    loading.style.display = "block"; // Ø¥Ø¸Ù‡Ø§Ø± Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„

    const q = await getDocs(collection(db, "emergency"));

    box.innerHTML = "";

    q.forEach(docSnap => {
        const d = docSnap.data();
        const id = docSnap.id;

        const imgSrc = d.img && d.img.trim() !== "" 
            ? d.img 
            : "https://i.postimg.cc/W1msLKWD/emergency-default.jpg";

        box.innerHTML += `
          <div class="card">

            <img class="map-img" src="${imgSrc}" alt="ØµÙˆØ±Ø© Ø§Ù„Ø·ÙˆØ§Ø±Ø¦">

            <h3>${d.name}</h3>
            <p><strong>Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©:</strong> ${d.city || "ØºÙŠØ± Ù…Ø­Ø¯Ø¯"}</p>
            <p><strong>Ø§Ù„Ù‡Ø§ØªÙ:</strong> ${d.phone || "ØºÙŠØ± Ù…Ø­Ø¯Ø¯"}</p>

            <a class="btn" href="emergency-details.html?id=${id}">
              ğŸ‘ Ø¹Ø±Ø¶ Ø§Ù„ØªÙØ§ØµÙŠÙ„
            </a>

          </div>
        `;
    });

    loading.style.display = "none"; // Ø¥Ø®ÙØ§Ø¡ Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„
}

loadEmergency();

</script>

</body>
</html>