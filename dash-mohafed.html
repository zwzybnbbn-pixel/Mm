<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… - Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.rtl.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* Ù†ÙØ³ Ø§Ù„ØªÙ†Ø³ÙŠÙ‚Ø§Øª Ø§Ù„Ø³Ø§Ø¨Ù‚Ø© */
        :root {
            --primary-color: #4361ee;
            --secondary-color: #3f37c9;
            --success-color: #4cc9f0;
            --dark-color: #1a1a2e;
            --light-color: #f8f9fa;
        }
        
        body {
            background-color: #f5f7fb;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            min-height: 100vh;
        }
        
        .login-container {
            max-width: 400px;
            margin: 100px auto;
            padding: 40px 30px;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            background-color: white;
        }
        
        .sidebar {
            background: linear-gradient(180deg, var(--dark-color) 0%, #16213e 100%);
            color: white;
            min-height: 100vh;
            transition: all 0.3s;
        }
        
        .sidebar .nav-link {
            color: #b1b1b1;
            padding: 12px 20px;
            margin: 5px 0;
            border-radius: 8px;
            transition: all 0.3s;
        }
        
        .sidebar .nav-link:hover, .sidebar .nav-link.active {
            background-color: rgba(67, 97, 238, 0.2);
            color: white;
        }
        
        .sidebar .nav-link i {
            width: 25px;
        }
        
        .main-content {
            padding: 20px;
        }
        
        .card-custom {
            border: none;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
            transition: transform 0.3s;
            margin-bottom: 20px;
        }
        
        .card-custom:hover {
            transform: translateY(-5px);
        }
        
        .stat-card {
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
            color: white;
        }
        
        .btn-custom {
            background-color: var(--primary-color);
            border: none;
            border-radius: 8px;
            padding: 10px 20px;
            color: white;
            transition: all 0.3s;
        }
        
        .btn-custom:hover {
            background-color: var(--secondary-color);
            color: white;
            transform: translateY(-2px);
        }
        
        .table-custom {
            background-color: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
        }
        
        .status-badge {
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 500;
        }
        
        .status-planning {
            background-color: #fff3cd;
            color: #856404;
        }
        
        .status-in-progress {
            background-color: #cce5ff;
            color: #004085;
        }
        
        .status-completed {
            background-color: #d4edda;
            color: #155724;
        }
        
        .page-title {
            color: var(--dark-color);
            border-bottom: 3px solid var(--primary-color);
            padding-bottom: 10px;
            display: inline-block;
            margin-bottom: 25px;
        }
        
        .loader {
            border: 5px solid #f3f3f3;
            border-top: 5px solid var(--primary-color);
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin: 100px auto;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .logout-btn {
            cursor: pointer;
        }
    </style>
</head>
<body>
    <!-- ØµÙØ­Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ -->
    <div id="login-page">
        <div class="login-container">
            <div class="text-center mb-4">
                <i class="fas fa-lock fa-3x mb-3" style="color: var(--primary-color);"></i>
                <h2 style="color: var(--dark-color);">ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…Ø¯ÙŠØ±</h2>
                <p class="text-muted">ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ù„Ø¯ÙŠÙƒ Ø­Ø³Ø§Ø¨ Ù…Ø¯ÙŠØ± Ù„Ù„ÙˆØµÙˆÙ„</p>
            </div>
            
            <div id="login-error" class="alert alert-danger d-none"></div>
            
            <form id="login-form">
                <div class="mb-3">
                    <label for="email" class="form-label">Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</label>
                    <input type="email" class="form-control" id="email" required autocomplete="email">
                </div>
                <div class="mb-3">
                    <label for="password" class="form-label">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</label>
                    <input type="password" class="form-control" id="password" required autocomplete="current-password">
                </div>
                <button type="submit" class="btn btn-custom w-100">
                    <i class="fas fa-sign-in-alt me-2"></i>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
                </button>
            </form>
            
            <div class="mt-3 text-center">
                <small class="text-muted">
                    Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Supabase Authentication
                </small>
            </div>
        </div>
    </div>

    <!-- Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… (Ø³ØªØ¸Ù‡Ø± ÙÙ‚Ø· Ø¨Ø¹Ø¯ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„) -->
    <div id="dashboard" class="d-none">
        <!-- Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ†Ù‚Ù„ Ø§Ù„Ø¹Ù„ÙˆÙŠ -->
        <nav class="navbar navbar-expand-lg navbar-dark" style="background-color: var(--dark-color);">
            <div class="container-fluid">
                <a class="navbar-brand" href="#">
                    <i class="fas fa-chart-line"></i> Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…
                </a>
                <div class="ms-auto d-flex align-items-center">
                    <span class="text-light me-3">
                        <i class="fas fa-user-circle me-1"></i>
                        <span id="current-user">Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</span>
                    </span>
                    <button id="logout-btn" class="btn btn-outline-light btn-sm">
                        <i class="fas fa-sign-out-alt me-1"></i>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬
                    </button>
                </div>
            </div>
        </nav>

        <div class="container-fluid">
            <div class="row">
                <!-- Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠ -->
                <div class="col-lg-2 col-md-3 p-0">
                    <div class="sidebar">
                        <div class="p-3 text-center">
                            <div class="mb-3">
                                <i class="fas fa-user-circle fa-3x text-primary"></i>
                            </div>
                            <h6 id="sidebar-user">Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</h6>
                            <small class="text-muted" id="user-email"></small>
                        </div>
                        <ul class="nav flex-column">
                            <li class="nav-item">
                                <a class="nav-link active" href="#stats" data-page="stats">
                                    <i class="fas fa-chart-bar"></i> Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
                                </a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="#projects" data-page="projects">
                                    <i class="fas fa-project-diagram"></i> Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹
                                </a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="#add-project" data-page="add-project">
                                    <i class="fas fa-plus-circle"></i> Ø¥Ø¶Ø§ÙØ© Ù…Ø´Ø±ÙˆØ¹
                                </a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="#add-stat" data-page="add-stat">
                                    <i class="fas fa-chart-line"></i> Ø¥Ø¶Ø§ÙØ© Ø¥Ø­ØµØ§Ø¦ÙŠØ©
                                </a>
                            </li>
                        </ul>
                    </div>
                </div>

                <!-- Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ -->
                <div class="col-lg-10 col-md-9 main-content">
                    <!-- Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª -->
                    <div id="stats-page" class="page-content">
                        <h2 class="page-title">Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª</h2>
                        <div class="row" id="stats-container">
                            <!-- Ø³ÙŠØªÙ… ØªØ¹Ø¨Ø¦Ø© Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ù‡Ù†Ø§ -->
                        </div>
                        <div class="table-responsive mt-4">
                            <table class="table table-hover table-custom">
                                <thead class="table-dark">
                                    <tr>
                                        <th>#</th>
                                        <th>Ø§Ø³Ù… Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ©</th>
                                        <th>Ø§Ù„Ù‚ÙŠÙ…Ø©</th>
                                        <th>Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
                                    </tr>
                                </thead>
                                <tbody id="stats-table">
                                    <!-- Ø³ÙŠØªÙ… ØªØ¹Ø¨Ø¦Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù‡Ù†Ø§ -->
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹ -->
                    <div id="projects-page" class="page-content d-none">
                        <h2 class="page-title">Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹</h2>
                        <div class="row" id="projects-container">
                            <!-- Ø³ÙŠØªÙ… ØªØ¹Ø¨Ø¦Ø© Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹ Ù‡Ù†Ø§ -->
                        </div>
                    </div>

                    <!-- Ø¥Ø¶Ø§ÙØ© Ù…Ø´Ø±ÙˆØ¹ -->
                    <div id="add-project-page" class="page-content d-none">
                        <h2 class="page-title">Ø¥Ø¶Ø§ÙØ© Ù…Ø´Ø±ÙˆØ¹ Ø¬Ø¯ÙŠØ¯</h2>
                        <div class="card card-custom">
                            <div class="card-body">
                                <form id="add-project-form">
                                    <div class="mb-3">
                                        <label for="project-title" class="form-label">Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…Ø´Ø±ÙˆØ¹</label>
                                        <input type="text" class="form-control" id="project-title" required>
                                    </div>
                                    <div class="mb-3">
                                        <label for="project-description" class="form-label">ÙˆØµÙ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹</label>
                                        <textarea class="form-control" id="project-description" rows="4"></textarea>
                                    </div>
                                    <div class="mb-3">
                                        <label for="project-image" class="form-label">Ø±Ø§Ø¨Ø· Ø§Ù„ØµÙˆØ±Ø©</label>
                                        <input type="url" class="form-control" id="project-image" placeholder="https://images.unsplash.com/...">
                                        <div class="form-text">ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø±Ø§Ø¨Ø· Ù…Ù† Unsplash Ø£Ùˆ Ø£ÙŠ Ù…ÙˆÙ‚Ø¹ Ø¢Ø®Ø±</div>
                                    </div>
                                    <div class="mb-3">
                                        <label for="project-status" class="form-label">Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø´Ø±ÙˆØ¹</label>
                                        <select class="form-select" id="project-status" required>
                                            <option value="Ù…Ø®Ø·Ø· Ù„Ù‡">Ù…Ø®Ø·Ø· Ù„Ù‡</option>
                                            <option value="ØªØ­Øª Ø§Ù„ØªÙ†ÙÙŠØ°">ØªØ­Øª Ø§Ù„ØªÙ†ÙÙŠØ°</option>
                                            <option value="Ù…ÙƒØªÙ…Ù„">Ù…ÙƒØªÙ…Ù„</option>
                                        </select>
                                    </div>
                                    <button type="submit" class="btn btn-custom">Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø´Ø±ÙˆØ¹</button>
                                </form>
                            </div>
                        </div>
                    </div>

                    <!-- Ø¥Ø¶Ø§ÙØ© Ø¥Ø­ØµØ§Ø¦ÙŠØ© -->
                    <div id="add-stat-page" class="page-content d-none">
                        <h2 class="page-title">Ø¥Ø¶Ø§ÙØ© Ø¥Ø­ØµØ§Ø¦ÙŠØ© Ø¬Ø¯ÙŠØ¯Ø©</h2>
                        <div class="card card-custom">
                            <div class="card-body">
                                <form id="add-stat-form">
                                    <div class="mb-3">
                                        <label for="stat-label" class="form-label">Ø§Ø³Ù… Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ©</label>
                                        <input type="text" class="form-control" id="stat-label" required>
                                    </div>
                                    <div class="mb-3">
                                        <label for="stat-value" class="form-label">Ø§Ù„Ù‚ÙŠÙ…Ø©</label>
                                        <input type="number" class="form-control" id="stat-value" required>
                                    </div>
                                    <button type="submit" class="btn btn-custom">Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ©</button>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Loader -->
    <div id="loader" class="loader d-none"></div>

    <!-- Modal for editing -->
    <div class="modal fade" id="editModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">ØªØ¹Ø¯ÙŠÙ„</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="edit-form">
                        <input type="hidden" id="edit-id">
                        <input type="hidden" id="edit-type">
                        <div id="edit-fields">
                            <!-- Dynamic fields will be inserted here -->
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Ø¥Ù„ØºØ§Ø¡</button>
                    <button type="button" class="btn btn-custom" id="save-edit-btn">Ø­ÙØ¸ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script type="module">
        // Ø§Ø³ØªÙŠØ±Ø§Ø¯ ÙˆØ¸Ø§Ø¦Ù Supabase
        import { createClient } from "https://esm.sh/@supabase/supabase-js@2";

        const supabaseUrl = "https://gxuumjhtutkipvkljjhj.supabase.co";
        const supabaseKey = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imd4dXVtamh0dXRraXB2a2xqamhqIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjU1NTM2MzEsImV4cCI6MjA4MTEyOTYzMX0.rmsSRTQ57cAJ3VAiQMe0mdxEYcERh6zQDep7DN_frFI";
        
        // Ø¥Ù†Ø´Ø§Ø¡ Ø¹Ù…ÙŠÙ„ Supabase
        const supabase = createClient(supabaseUrl, supabaseKey, {
            auth: {
                persistSession: true,
                autoRefreshToken: true,
                detectSessionInUrl: true
            }
        });

        // Ø¹Ù†Ø§ØµØ± DOM
        const loginPage = document.getElementById('login-page');
        const dashboard = document.getElementById('dashboard');
        const loader = document.getElementById('loader');
        const loginForm = document.getElementById('login-form');
        const loginError = document.getElementById('login-error');
        const logoutBtn = document.getElementById('logout-btn');
        const currentUserSpan = document.getElementById('current-user');
        const sidebarUserSpan = document.getElementById('sidebar-user');
        const userEmailSpan = document.getElementById('user-email');
        const pages = {
            stats: document.getElementById('stats-page'),
            projects: document.getElementById('projects-page'),
            'add-project': document.getElementById('add-project-page'),
            'add-stat': document.getElementById('add-stat-page')
        };
        const navLinks = document.querySelectorAll('.sidebar .nav-link');
        const addProjectForm = document.getElementById('add-project-form');
        const addStatForm = document.getElementById('add-stat-form');

        // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
        document.addEventListener('DOMContentLoaded', async () => {
            console.log('ğŸš€ Ø¨Ø¯Ø¡ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚...');
            
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø¬Ù„Ø³Ø© Ø³Ø§Ø¨Ù‚Ø©
            const { data: { session }, error } = await supabase.auth.getSession();
            
            if (session) {
                // ÙŠÙˆØ¬Ø¯ Ø¬Ù„Ø³Ø© Ù†Ø´Ø·Ø©
                console.log('âœ… Ø¬Ù„Ø³Ø© Ù†Ø´Ø·Ø© Ù…ÙˆØ¬ÙˆØ¯Ø©:', session.user.email);
                await showDashboard(session.user);
            } else {
                // Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø¬Ù„Ø³Ø©
                showLoginPage();
            }
        });

        // Ø¹Ø±Ø¶ ØµÙØ­Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
        function showLoginPage() {
            loginPage.classList.remove('d-none');
            dashboard.classList.add('d-none');
            loginForm.reset();
            loginError.classList.add('d-none');
        }

        // Ø¹Ø±Ø¶ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…
        async function showDashboard(user) {
            if (!user) {
                showLoginPage();
                return;
            }
            
            // ØªØ­Ø¯ÙŠØ« Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙÙŠ Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©
            currentUserSpan.textContent = user.email;
            sidebarUserSpan.textContent = user.email.split('@')[0]; // Ø§Ù„Ø¬Ø²Ø¡ Ø§Ù„Ø£ÙˆÙ„ Ù…Ù† Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„
            userEmailSpan.textContent = user.email;
            
            // Ø¥Ø®ÙØ§Ø¡ ØµÙØ­Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ ÙˆØ¥Ø¸Ù‡Ø§Ø± Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…
            loginPage.classList.add('d-none');
            dashboard.classList.remove('d-none');
            
            // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
            await loadData();
            
            // Ø¹Ø±Ø¶ ØµÙØ­Ø© Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§ÙØªØ±Ø§Ø¶ÙŠÙ‹Ø§
            showPage('stats');
        }

        // ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
        loginForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const email = document.getElementById('email').value.trim();
            const password = document.getElementById('password').value;
            
            // Ø¥Ø®ÙØ§Ø¡ Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ø®Ø·Ø£ Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©
            loginError.classList.add('d-none');
            loginError.textContent = '';
            
            showLoader();
            
            try {
                // Ù…Ø­Ø§ÙˆÙ„Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Supabase Auth
                const { data, error } = await supabase.auth.signInWithPassword({
                    email: email,
                    password: password
                });
                
                if (error) {
                    throw error;
                }
                
                console.log('âœ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù†Ø§Ø¬Ø­:', data.user.email);
                
                // Ø¹Ø±Ø¶ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…
                await showDashboard(data.user);
            } catch (error) {
                console.error('âŒ Ø®Ø·Ø£ ÙÙŠ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„:', error);
                loginError.textContent = error.message || 'Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø£Ùˆ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± ØµØ­ÙŠØ­Ø©';
                loginError.classList.remove('d-none');
                
                // Ø§Ù‡ØªØ²Ø§Ø² Ø§Ù„Ø­Ù‚ÙˆÙ„
                document.getElementById('email').classList.add('is-invalid');
                document.getElementById('password').classList.add('is-invalid');
                
                setTimeout(() => {
                    document.getElementById('email').classList.remove('is-invalid');
                    document.getElementById('password').classList.remove('is-invalid');
                }, 2000);
            } finally {
                hideLoader();
            }
        });

        // ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬
        logoutBtn.addEventListener('click', async () => {
            showLoader();
            
            try {
                const { error } = await supabase.auth.signOut();
                
                if (error) {
                    throw error;
                }
                
                console.log('âœ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬ Ù†Ø§Ø¬Ø­');
                
                // Ø§Ù„Ø¹ÙˆØ¯Ø© Ø¥Ù„Ù‰ ØµÙØ­Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
                showLoginPage();
            } catch (error) {
                console.error('âŒ Ø®Ø·Ø£ ÙÙŠ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬:', error);
                alert('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬: ' + error.message);
            } finally {
                hideLoader();
            }
        });

        // Ø¹Ø±Ø¶ ØµÙØ­Ø© Ù…Ø­Ø¯Ø¯Ø©
        function showPage(pageName) {
            // Ø¥Ø®ÙØ§Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„ØµÙØ­Ø§Øª
            Object.values(pages).forEach(page => {
                page.classList.add('d-none');
            });
            
            // Ø¹Ø±Ø¶ Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©
            if (pages[pageName]) {
                pages[pageName].classList.remove('d-none');
            }
            
            // ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ù†Ø´Ø·Ø©
            navLinks.forEach(link => {
                if (link.getAttribute('data-page') === pageName) {
                    link.classList.add('active');
                } else {
                    link.classList.remove('active');
                }
            });
        }

        // ØªØ­Ù…ÙŠÙ„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
        async function loadData() {
            showLoader();
            
            try {
                await Promise.all([
                    loadStats(),
                    loadProjects()
                ]);
                
                console.log('âœ… ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­');
            } catch (error) {
                console.error('âŒ Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:', error);
                showError('Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª');
            } finally {
                hideLoader();
            }
        }

        // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
        async function loadStats() {
            const statsContainer = document.getElementById('stats-container');
            const statsTable = document.getElementById('stats-table');
            
            console.log('ğŸ“Š Ø¬Ù„Ø¨ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª...');
            
            try {
                // Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ø¬Ø¯ÙˆÙ„ stats
                const { data: stats, error } = await supabase
                    .from('stats')
                    .select('*')
                    .order('id', { ascending: true });
                
                if (error) {
                    throw error;
                }
                
                console.log(`âœ… ØªÙ… Ø¬Ù„Ø¨ ${stats.length} Ø¥Ø­ØµØ§Ø¦ÙŠØ©`);
                
                // Ø¹Ø±Ø¶ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª ÙƒØ¨Ø·Ø§Ù‚Ø§Øª
                statsContainer.innerHTML = '';
                if (stats.length === 0) {
                    statsContainer.innerHTML = `
                        <div class="col-12">
                            <div class="alert alert-info">
                                Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø¨Ø¹Ø¯. Ù‚Ù… Ø¨Ø¥Ø¶Ø§ÙØ© Ø¥Ø­ØµØ§Ø¦ÙŠØ© Ø¬Ø¯ÙŠØ¯Ø©.
                            </div>
                        </div>
                    `;
                } else {
                    stats.forEach(stat => {
                        const statCard = document.createElement('div');
                        statCard.className = 'col-md-3 col-sm-6 mb-3';
                        statCard.innerHTML = `
                            <div class="card card-custom stat-card">
                                <div class="card-body text-center">
                                    <h5 class="card-title">${stat.label}</h5>
                                    <h2 class="card-text display-6">${stat.value}</h2>
                                </div>
                            </div>
                        `;
                        statsContainer.appendChild(statCard);
                    });
                }
                
                // Ø¹Ø±Ø¶ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª ÙÙŠ Ø§Ù„Ø¬Ø¯ÙˆÙ„
                statsTable.innerHTML = '';
                stats.forEach(stat => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${stat.id}</td>
                        <td>${stat.label}</td>
                        <td>${stat.value}</td>
                        <td>
                            <button class="btn btn-sm btn-outline-primary edit-stat-btn" data-id="${stat.id}">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="btn btn-sm btn-outline-danger delete-stat-btn" data-id="${stat.id}">
                                <i class="fas fa-trash"></i>
                            </button>
                        </td>
                    `;
                    statsTable.appendChild(row);
                });
                
                // Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªÙ…Ø¹Ø§Øª Ø§Ù„Ø£Ø­Ø¯Ø§Ø« Ù„Ù„Ø£Ø²Ø±Ø§Ø±
                document.querySelectorAll('.edit-stat-btn').forEach(btn => {
                    btn.addEventListener('click', () => editStat(btn.dataset.id));
                });
                
                document.querySelectorAll('.delete-stat-btn').forEach(btn => {
                    btn.addEventListener('click', () => deleteStat(btn.dataset.id));
                });
            } catch (error) {
                console.error('âŒ Ø®Ø·Ø£ ÙÙŠ Ø¬Ù„Ø¨ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª:', error);
                statsContainer.innerHTML = `
                    <div class="col-12">
                        <div class="alert alert-danger">
                            <h5>Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª</h5>
                            <p>${error.message}</p>
                        </div>
                    </div>
                `;
            }
        }

        // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹
        async function loadProjects() {
            const projectsContainer = document.getElementById('projects-container');
            
            console.log('ğŸ“‹ Ø¬Ù„Ø¨ Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹...');
            
            try {
                // Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ø¬Ø¯ÙˆÙ„ projects
                const { data: projects, error } = await supabase
                    .from('projects')
                    .select('*')
                    .order('created_at', { ascending: false });
                
                if (error) {
                    throw error;
                }
                
                console.log(`âœ… ØªÙ… Ø¬Ù„Ø¨ ${projects.length} Ù…Ø´Ø±ÙˆØ¹`);
                displayProjects(projects);
                
            } catch (error) {
                console.error('âŒ Ø®Ø·Ø£ ÙÙŠ Ø¬Ù„Ø¨ Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹:', error);
                projectsContainer.innerHTML = `
                    <div class="col-12">
                        <div class="alert alert-danger">
                            <h5>Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹</h5>
                            <p>${error.message}</p>
                        </div>
                    </div>
                `;
            }
        }

        // Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹
        function displayProjects(projects) {
            const projectsContainer = document.getElementById('projects-container');
            
            projectsContainer.innerHTML = '';
            
            if (projects.length === 0) {
                projectsContainer.innerHTML = `
                    <div class="col-12">
                        <div class="alert alert-info">
                            Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø´Ø§Ø±ÙŠØ¹ Ø¨Ø¹Ø¯. Ù‚Ù… Ø¨Ø¥Ø¶Ø§ÙØ© Ù…Ø´Ø±ÙˆØ¹ Ø¬Ø¯ÙŠØ¯.
                        </div>
                    </div>
                `;
                return;
            }
            
            projects.forEach(project => {
                // ØªØ­Ø¯ÙŠØ¯ Ù„ÙˆÙ† Ø§Ù„Ø­Ø§Ù„Ø©
                let statusClass = 'status-planning';
                if (project.status === 'ØªØ­Øª Ø§Ù„ØªÙ†ÙÙŠØ°') statusClass = 'status-in-progress';
                if (project.status === 'Ù…ÙƒØªÙ…Ù„') statusClass = 'status-completed';
                
                // ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„ØªØ§Ø±ÙŠØ®
                let formattedDate = 'ØªØ§Ø±ÙŠØ® ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ';
                if (project.created_at) {
                    try {
                        const date = new Date(project.created_at);
                        formattedDate = date.toLocaleDateString('ar-SA');
                    } catch (e) {
                        console.warn('Ø®Ø·Ø£ ÙÙŠ ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„ØªØ§Ø±ÙŠØ®:', e);
                    }
                }
                
                // ØµÙˆØ±Ø© Ø§ÙØªØ±Ø§Ø¶ÙŠØ© Ø¥Ø°Ø§ Ù„Ù… ØªÙƒÙ† Ù…ÙˆØ¬ÙˆØ¯Ø©
                const imageUrl = project.image_url || 'https://images.unsplash.com/photo-1551288049-bebda4e38f71?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=80';
                
                const projectCard = document.createElement('div');
                projectCard.className = 'col-md-4 col-sm-6 mb-4';
                projectCard.innerHTML = `
                    <div class="card card-custom h-100">
                        <img src="${imageUrl}" class="card-img-top" alt="${project.title || 'Ù…Ø´Ø±ÙˆØ¹'}" 
                             style="height: 200px; object-fit: cover; border-top-left-radius: 15px; border-top-right-radius: 15px;">
                        <div class="card-body d-flex flex-column">
                            <h5 class="card-title">${project.title || 'Ø¨Ø¯ÙˆÙ† Ø¹Ù†ÙˆØ§Ù†'}</h5>
                            <p class="card-text flex-grow-1">${project.description || 'Ù„Ø§ ÙŠÙˆØ¬Ø¯ ÙˆØµÙ Ù„Ù„Ù…Ø´Ø±ÙˆØ¹'}</p>
                            <div class="mt-auto">
                                <div class="d-flex justify-content-between align-items-center">
                                    <span class="status-badge ${statusClass}">${project.status || 'Ù…Ø®Ø·Ø· Ù„Ù‡'}</span>
                                    <small class="text-muted">${formattedDate}</small>
                                </div>
                                <div class="mt-3 d-flex justify-content-end">
                                    <button class="btn btn-sm btn-outline-primary edit-project-btn me-2" data-id="${project.id}">
                                        <i class="fas fa-edit"></i> ØªØ¹Ø¯ÙŠÙ„
                                    </button>
                                    <button class="btn btn-sm btn-outline-danger delete-project-btn" data-id="${project.id}">
                                        <i class="fas fa-trash"></i> Ø­Ø°Ù
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
                projectsContainer.appendChild(projectCard);
            });
            
            // Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªÙ…Ø¹Ø§Øª Ø§Ù„Ø£Ø­Ø¯Ø§Ø« Ù„Ù„Ø£Ø²Ø±Ø§Ø±
            document.querySelectorAll('.edit-project-btn').forEach(btn => {
                btn.addEventListener('click', () => editProject(btn.dataset.id));
            });
            
            document.querySelectorAll('.delete-project-btn').forEach(btn => {
                btn.addEventListener('click', () => deleteProject(btn.dataset.id));
            });
        }

        // Ø¥Ø¶Ø§ÙØ© Ù…Ø´Ø±ÙˆØ¹ Ø¬Ø¯ÙŠØ¯
        addProjectForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const title = document.getElementById('project-title').value;
            const description = document.getElementById('project-description').value;
            const image_url = document.getElementById('project-image').value || 'https://images.unsplash.com/photo-1551288049-bebda4e38f71?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=80';
            const status = document.getElementById('project-status').value;
            
            if (!title.trim()) {
                alert('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…Ø´Ø±ÙˆØ¹');
                return;
            }
            
            showLoader();
            
            console.log('â• Ø¥Ø¶Ø§ÙØ© Ù…Ø´Ø±ÙˆØ¹ Ø¬Ø¯ÙŠØ¯:', { title, status });
            
            try {
                const { data, error } = await supabase
                    .from('projects')
                    .insert([{ 
                        title, 
                        description, 
                        image_url, 
                        status,
                        created_at: new Date().toISOString()
                    }])
                    .select();
                
                if (error) throw error;
                
                console.log('âœ… ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ Ø¨Ù†Ø¬Ø§Ø­:', data);
                alert('ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ Ø¨Ù†Ø¬Ø§Ø­!');
                addProjectForm.reset();
                
                // Ø¥Ø¹Ø§Ø¯Ø© ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹
                await loadProjects();
                
                // Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¥Ù„Ù‰ ØµÙØ­Ø© Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹
                showPage('projects');
            } catch (error) {
                console.error('âŒ Ø®Ø·Ø£:', error);
                alert('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø´Ø±ÙˆØ¹: ' + error.message);
            } finally {
                hideLoader();
            }
        });

        // Ø¥Ø¶Ø§ÙØ© Ø¥Ø­ØµØ§Ø¦ÙŠØ© Ø¬Ø¯ÙŠØ¯Ø©
        addStatForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const label = document.getElementById('stat-label').value;
            const value = document.getElementById('stat-value').value;
            
            if (!label.trim()) {
                alert('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ©');
                return;
            }
            
            if (!value || value < 0) {
                alert('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ù‚ÙŠÙ…Ø© ØµØ­ÙŠØ­Ø©');
                return;
            }
            
            showLoader();
            
            console.log('â• Ø¥Ø¶Ø§ÙØ© Ø¥Ø­ØµØ§Ø¦ÙŠØ© Ø¬Ø¯ÙŠØ¯Ø©:', { label, value });
            
            try {
                const { data, error } = await supabase
                    .from('stats')
                    .insert([{ label, value: parseFloat(value) }])
                    .select();
                
                if (error) throw error;
                
                console.log('âœ… ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ© Ø¨Ù†Ø¬Ø§Ø­:', data);
                alert('ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ© Ø¨Ù†Ø¬Ø§Ø­!');
                addStatForm.reset();
                
                // Ø¥Ø¹Ø§Ø¯Ø© ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
                await loadStats();
                
                // Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¥Ù„Ù‰ ØµÙØ­Ø© Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
                showPage('stats');
            } catch (error) {
                console.error('âŒ Ø®Ø·Ø£:', error);
                alert('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ©: ' + error.message);
            } finally {
                hideLoader();
            }
        });

        // ØªØ­Ø±ÙŠØ± Ø¥Ø­ØµØ§Ø¦ÙŠØ©
        async function editStat(id) {
            console.log('âœï¸ ØªØ­Ø±ÙŠØ± Ø¥Ø­ØµØ§Ø¦ÙŠØ©:', id);
            
            showLoader();
            
            try {
                // Ø¬Ù„Ø¨ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ©
                const { data: stat, error } = await supabase
                    .from('stats')
                    .select('*')
                    .eq('id', id)
                    .single();
                
                if (error) throw error;
                
                // ØªØ¹Ø¨Ø¦Ø© Ø§Ù„Ù†Ù…ÙˆØ°Ø¬
                document.getElementById('edit-id').value = id;
                document.getElementById('edit-type').value = 'stat';
                
                const fields = document.getElementById('edit-fields');
                fields.innerHTML = `
                    <div class="mb-3">
                        <label for="edit-label" class="form-label">Ø§Ø³Ù… Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ©</label>
                        <input type="text" class="form-control" id="edit-label" value="${stat.label}" required>
                    </div>
                    <div class="mb-3">
                        <label for="edit-value" class="form-label">Ø§Ù„Ù‚ÙŠÙ…Ø©</label>
                        <input type="number" class="form-control" id="edit-value" value="${stat.value}" required>
                    </div>
                `;
                
                // Ø¹Ø±Ø¶ Ø§Ù„Ù…ÙˆØ¯Ø§Ù„
                const modal = new bootstrap.Modal(document.getElementById('editModal'));
                modal.show();
            } catch (error) {
                console.error('âŒ Ø®Ø·Ø£:', error);
                alert('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ©: ' + error.message);
            } finally {
                hideLoader();
            }
        }

        // ØªØ­Ø±ÙŠØ± Ù…Ø´Ø±ÙˆØ¹
        async function editProject(id) {
            console.log('âœï¸ ØªØ­Ø±ÙŠØ± Ù…Ø´Ø±ÙˆØ¹:', id);
            
            showLoader();
            
            try {
                // Ø¬Ù„Ø¨ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø´Ø±ÙˆØ¹
                const { data: project, error } = await supabase
                    .from('projects')
                    .select('*')
                    .eq('id', id)
                    .single();
                
                if (error) throw error;
                
                // ØªØ¹Ø¨Ø¦Ø© Ø§Ù„Ù†Ù…ÙˆØ°Ø¬
                document.getElementById('edit-id').value = id;
                document.getElementById('edit-type').value = 'project';
                
                const fields = document.getElementById('edit-fields');
                fields.innerHTML = `
                    <div class="mb-3">
                        <label for="edit-title" class="form-label">Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…Ø´Ø±ÙˆØ¹</label>
                        <input type="text" class="form-control" id="edit-title" value="${project.title}" required>
                    </div>
                    <div class="mb-3">
                        <label for="edit-description" class="form-label">ÙˆØµÙ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹</label>
                        <textarea class="form-control" id="edit-description" rows="3">${project.description || ''}</textarea>
                    </div>
                    <div class="mb-3">
                        <label for="edit-image" class="form-label">Ø±Ø§Ø¨Ø· Ø§Ù„ØµÙˆØ±Ø©</label>
                        <input type="url" class="form-control" id="edit-image" value="${project.image_url || ''}">
                    </div>
                    <div class="mb-3">
                        <label for="edit-status" class="form-label">Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø´Ø±ÙˆØ¹</label>
                        <select class="form-select" id="edit-status" required>
                            <option value="Ù…Ø®Ø·Ø· Ù„Ù‡" ${project.status === 'Ù…Ø®Ø·Ø· Ù„Ù‡' ? 'selected' : ''}>Ù…Ø®Ø·Ø· Ù„Ù‡</option>
                            <option value="ØªØ­Øª Ø§Ù„ØªÙ†ÙÙŠØ°" ${project.status === 'ØªØ­Øª Ø§Ù„ØªÙ†ÙÙŠØ°' ? 'selected' : ''}>ØªØ­Øª Ø§Ù„ØªÙ†ÙÙŠØ°</option>
                            <option value="Ù…ÙƒØªÙ…Ù„" ${project.status === 'Ù…ÙƒØªÙ…Ù„' ? 'selected' : ''}>Ù…ÙƒØªÙ…Ù„</option>
                        </select>
                    </div>
                `;
                
                // Ø¹Ø±Ø¶ Ø§Ù„Ù…ÙˆØ¯Ø§Ù„
                const modal = new bootstrap.Modal(document.getElementById('editModal'));
                modal.show();
            } catch (error) {
                console.error('âŒ Ø®Ø·Ø£:', error);
                alert('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø´Ø±ÙˆØ¹: ' + error.message);
            } finally {
                hideLoader();
            }
        }

        // Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª
        document.getElementById('save-edit-btn').addEventListener('click', async () => {
            const id = document.getElementById('edit-id').value;
            const type = document.getElementById('edit-type').value;
            
            showLoader();
            
            try {
                if (type === 'stat') {
                    const label = document.getElementById('edit-label').value;
                    const value = document.getElementById('edit-value').value;
                    
                    console.log('ğŸ’¾ Ø­ÙØ¸ Ø¥Ø­ØµØ§Ø¦ÙŠØ©:', { id, label, value });
                    
                    const { error } = await supabase
                        .from('stats')
                        .update({ label, value: parseFloat(value) })
                        .eq('id', id);
                    
                    if (error) throw error;
                    
                    alert('ØªÙ… ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ© Ø¨Ù†Ø¬Ø§Ø­!');
                    await loadStats();
                    
                } else if (type === 'project') {
                    const title = document.getElementById('edit-title').value;
                    const description = document.getElementById('edit-description').value;
                    const image_url = document.getElementById('edit-image').value || 'https://images.unsplash.com/photo-1551288049-bebda4e38f71?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=80';
                    const status = document.getElementById('edit-status').value;
                    
                    console.log('ğŸ’¾ Ø­ÙØ¸ Ù…Ø´Ø±ÙˆØ¹:', { id, title, status });
                    
                    const { error } = await supabase
                        .from('projects')
                        .update({ title, description, image_url, status })
                        .eq('id', id);
                    
                    if (error) throw error;
                    
                    alert('ØªÙ… ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ Ø¨Ù†Ø¬Ø§Ø­!');
                    await loadProjects();
                }
                
                // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù…ÙˆØ¯Ø§Ù„
                const modal = bootstrap.Modal.getInstance(document.getElementById('editModal'));
                modal.hide();
                
            } catch (error) {
                console.error('âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø­ÙØ¸:', error);
                alert('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø­ÙØ¸: ' + error.message);
            } finally {
                hideLoader();
            }
        });

        // Ø­Ø°Ù Ø¥Ø­ØµØ§Ø¦ÙŠØ©
        async function deleteStat(id) {
            if (!confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ù‡ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ©ØŸ')) return;
            
            console.log('ğŸ—‘ï¸ Ø­Ø°Ù Ø¥Ø­ØµØ§Ø¦ÙŠØ©:', id);
            
            showLoader();
            
            try {
                const { error } = await supabase
                    .from('stats')
                    .delete()
                    .eq('id', id);
                
                if (error) throw error;
                
                alert('ØªÙ… Ø­Ø°Ù Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ© Ø¨Ù†Ø¬Ø§Ø­!');
                await loadStats();
            } catch (error) {
                console.error('âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø­Ø°Ù:', error);
                alert('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø­Ø°Ù: ' + error.message);
            } finally {
                hideLoader();
            }
        }

        // Ø­Ø°Ù Ù…Ø´Ø±ÙˆØ¹
        async function deleteProject(id) {
            if (!confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ØŸ')) return;
            
            console.log('ğŸ—‘ï¸ Ø­Ø°Ù Ù…Ø´Ø±ÙˆØ¹:', id);
            
            showLoader();
            
            try {
                const { error } = await supabase
                    .from('projects')
                    .delete()
                    .eq('id', id);
                
                if (error) throw error;
                
                alert('ØªÙ… Ø­Ø°Ù Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ Ø¨Ù†Ø¬Ø§Ø­!');
                await loadProjects();
            } catch (error) {
                console.error('âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø­Ø°Ù:', error);
                alert('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø­Ø°Ù: ' + error.message);
            } finally {
                hideLoader();
            }
        }

        // Ø§Ù„ØªÙ†Ù‚Ù„ Ø¨ÙŠÙ† Ø§Ù„ØµÙØ­Ø§Øª
        navLinks.forEach(link => {
            link.addEventListener('click', (e) => {
                e.preventDefault();
                
                const page = link.getAttribute('data-page');
                showPage(page);
            });
        });

        // ÙˆØ¸Ø§Ø¦Ù Ù…Ø³Ø§Ø¹Ø¯Ø©
        function showLoader() {
            loader.classList.remove('d-none');
        }
        
        function hideLoader() {
            loader.classList.add('d-none');
        }
        
        function showError(message) {
            alert(message);
        }
    </script>
</body>
</html>