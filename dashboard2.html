<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</title>

<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;800&display=swap" rel="stylesheet">

<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:'Cairo',sans-serif;}

/* Ø´Ø§Ø´Ø© Ø§Ù„Ø­Ø¸Ø± Ø§Ù„ÙƒØ§Ù…Ù„Ø© */
body{
  background:linear-gradient(135deg, #0a0a0a, #111, #1a1a1a, #222);
  min-height:100vh;
  display:flex;
  justify-content:center;
  align-items:center;
  color:white;
  padding:20px;
}

/* Ø§Ù„Ø­Ø§ÙˆÙŠØ© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© */
.container{
  width:100%;
  max-width:800px;
  text-align:center;
}

/* Ø´Ø§Ø´Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„ */
#loading-screen {
  display:flex;
  flex-direction:column;
  justify-content:center;
  align-items:center;
  padding:40px 30px;
  background:rgba(255,255,255,0.05);
  border-radius:20px;
  backdrop-filter:blur(10px);
  box-shadow:0 10px 30px rgba(0,0,0,0.5);
  border:1px solid rgba(255,255,255,0.1);
}

.spinner {
  width:70px;
  height:70px;
  border:6px solid rgba(255,255,255,0.1);
  border-top-color:#ff4c4c;
  border-radius:50%;
  animation:spin 1s ease-in-out infinite;
  margin-bottom:25px;
}

@keyframes spin { to { transform:rotate(360deg); } }

.loading-text { font-size:22px; font-weight:700; color:white; margin-bottom:10px; }
.loading-subtext { font-size:16px; opacity:0.7; color:#aaa; }

/* Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø®Ø·Ø£ */
#error-message {
  display:none;
  flex-direction:column;
  justify-content:center;
  align-items:center;
  padding:40px 30px;
  background:rgba(255,255,255,0.05);
  border-radius:20px;
  backdrop-filter:blur(10px);
  box-shadow:0 10px 30px rgba(0,0,0,0.5);
  border:1px solid rgba(255,255,255,0.1);
  animation:fadeIn 0.5s ease;
}

@keyframes fadeIn { from{opacity:0; transform:translateY(20px);} to{opacity:1; transform:translateY(0);} }

.error-icon { font-size:70px; color:#ff4c4c; margin-bottom:25px; }
.error-title { font-size:28px; font-weight:800; margin-bottom:15px; color:white; }
.error-description { font-size:18px; margin-bottom:30px; color:#ccc; line-height:1.6; max-width:400px; }

.login-btn {
  background:linear-gradient(135deg, #ff4c4c, #ff6b6b);
  color:white;
  border:none;
  padding:15px 35px;
  border-radius:12px;
  font-size:18px;
  font-weight:700;
  cursor:pointer;
  transition:0.3s;
  display:flex;
  align-items:center;
  gap:12px;
}

.login-btn:hover {
  background:linear-gradient(135deg, #ff6b6b, #ff4c4c);
  transform:translateY(-3px);
  box-shadow:0 7px 20px rgba(255,107,107,0.4);
}

/* Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ */
#main-content { display:none; width:100%; }

.main-wrapper{ flex:1; display:flex; flex-direction:column; align-items:center; text-align:center; padding:30px 10px; }

header h1{ font-size:38px; font-weight:800; margin-bottom:10px; }
header p{ font-size:20px; opacity:.9; margin-bottom:25px; }

/* Cards */
.cards{ width:100%; max-width:600px; display:flex; flex-direction:column; gap:18px; }

.card{
  background:rgba(255,255,255,0.07);
  padding:20px;
  border-radius:16px;
  text-align:center;
  backdrop-filter:blur(5px);
  box-shadow:0 6px 18px rgba(0,0,0,0.45);
  transition:0.25s;
  cursor:pointer;
}

.card:hover{
  background:rgba(255,255,255,0.12);
  transform:scale(1.03);
}

.card-title{ font-size:24px; font-weight:800; margin-bottom:6px; }
.card-value{ font-size:18px; margin-bottom:14px; opacity:.95; }

/* Ø²Ø± ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬ */
.logout-btn{
  background:#ff4c4c;
  padding:12px 20px;
  border-radius:12px;
  text-align:center;
  color:white;
  font-weight:800;
  width:100%;
  max-width:600px;
  margin-top:20px;
  cursor:pointer;
  transition:0.2s;
}

.logout-btn:hover{ background:#ff6b6b; }

/* Footer */
footer{ text-align:center; opacity:.9; font-size:18px; padding:15px 10px; margin-top:25px; }
</style>
</head>

<body>
<div class="container">
  
  <!-- Ø´Ø§Ø´Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„ -->
  <div id="loading-screen">
    <div class="spinner"></div>
    <div class="loading-text">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµÙ„Ø§Ø­ÙŠØ© Ø§Ù„Ø¯Ø®ÙˆÙ„...</div>
    <div class="loading-subtext">ÙŠØ¬Ø¨ Ø£Ù† ØªÙƒÙˆÙ† Ù…Ø³Ø¬Ù„Ø§Ù‹ Ù„Ù„Ø¯Ø®ÙˆÙ„</div>
  </div>
  
  <!-- Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø®Ø·Ø£ -->
  <div id="error-message">
    <div class="error-icon">ğŸš«</div>
    <h2 class="error-title">ØºÙŠØ± Ù…ØµØ±Ø­ Ø¨Ø§Ù„Ø¯Ø®ÙˆÙ„</h2>
    <p class="error-description">ÙŠØ¬Ø¨ Ø¹Ù„ÙŠÙƒ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£ÙˆÙ„Ø§Ù‹ Ù„Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</p>
    <button class="login-btn" onclick="goToLogin()">
      <span>ğŸ‘‰ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø¢Ù†</span>
    </button>
    <div style="margin-top:20px; color:#888; font-size:14px;">
      Ø¥Ø°Ø§ ÙƒÙ†Øª Ù‚Ø¯ Ø³Ø¬Ù„Øª Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù…Ø³Ø¨Ù‚Ø§Ù‹ØŒ Ø¬Ø±Ø¨ <a href="javascript:location.reload()" style="color:#4cd964; text-decoration:none;">Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„</a>
    </div>
  </div>
  
  <!-- Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ -->
  <div id="main-content">
    <div class="main-wrapper">
      <header>
        <h1>âš™ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</h1>
        <div id="user-info" style="font-size:20px; opacity:.9; margin-bottom:25px;">
          Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…...
        </div>
      </header>

      <div class="cards">
        <div class="card" onclick="goToPage('dashboard-alerts.html')">
          <div class="card-title">ğŸ”” Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª</div>
          <div class="card-value">Ø¥Ø¶Ø§ÙØ© â€“ ØªØ¹Ø¯ÙŠÙ„ â€“ Ø­Ø°Ù</div>
        </div>

        <div class="card" onclick="goToPage('dashboard-reasons.html')">
          <div class="card-title">âš¡ Ø¥Ø¯Ø§Ø±Ø© Ø£Ø³Ø¨Ø§Ø¨ Ø§Ù„Ø§Ù†Ù‚Ø·Ø§Ø¹</div>
          <div class="card-value">Ø¹Ø±Ø¶ â€“ ØªØ¹Ø¯ÙŠÙ„ â€“ Ø­Ø°Ù</div>
        </div>

        <div class="card" onclick="goToPage('dashboard-schedule.html')">
          <div class="card-title">ğŸ“… Ø¥Ø¯Ø§Ø±Ø© Ø¬Ø¯ÙˆÙ„ Ø§Ù„ØªØ´ØºÙŠÙ„</div>
          <div class="card-value">ØªØ´ØºÙŠÙ„ â€“ Ø§Ù†Ø·ÙØ§Ø¡ â€“ ØªØ­Ø¯ÙŠØ«</div>
        </div>

        <div class="card" onclick="goToPage('dashboard-reports.html')">
          <div class="card-title">ğŸ“¢ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¨Ù„Ø§ØºØ§Øª</div>
          <div class="card-value">Ø§Ù„Ø±Ø¯ â€“ ØªØºÙŠÙŠØ± Ø§Ù„Ø­Ø§Ù„Ø© â€“ Ø­Ø°Ù</div>
        </div>
      </div>

      <div class="logout-btn" id="logoutBtn">ğŸšª ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</div>

      <footer>
        <p>Ù…/Ù…Ø§Ø¬Ø¯ Ù‚Ø§Ø³Ù… Ø­Ø³Ù† Ù…Ø¨Ø§Ø±Ùƒ Ø¨Ù† Ø¹Ù…Ø±Ùˆ</p>
        Â© 2025 â€“ Ù…Ù†ØµØ© ÙƒÙ‡Ø±Ø¨Ø§Ø¡ Ø¹ØªÙ‚
      </footer>
    </div>
  </div>

</div>

<!-- Supabase SDK -->
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script>
const SUPABASE_URL = "https://gxuumjhtutkipvkljjhj.supabase.co";
const SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...";
const supabase = supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

const loadingScreen = document.getElementById('loading-screen');
const errorMessage = document.getElementById('error-message');
const mainContent = document.getElementById('main-content');
const userInfoElem = document.getElementById('user-info');
const logoutBtn = document.getElementById('logoutBtn');

function showLoading() {
  loadingScreen.style.display = 'flex';
  errorMessage.style.display = 'none';
  mainContent.style.display = 'none';
}

function showError() {
  loadingScreen.style.display = 'none';
  errorMessage.style.display = 'flex';
  mainContent.style.display = 'none';
}

function showContent(user) {
  loadingScreen.style.display = 'none';
  errorMessage.style.display = 'none';
  mainContent.style.display = 'block';
  userInfoElem.innerHTML = `
    Ù…Ø±Ø­Ø¨Ø§Ù‹ <strong style="color:#4cd964">${user.user_metadata?.name || user.email}</strong>
    <div style="font-size:16px; opacity:0.7;">Ø§Ù„Ø¨Ø±ÙŠØ¯: ${user.email}</div>
  `;
}

async function checkSession() {
  showLoading();
  const { data: { session }, error } = await supabase.auth.getSession();
  if (error || !session) {
    showError();
    return null;
  }
  showContent(session.user);
  return session.user;
}

logoutBtn.addEventListener('click', async () => {
  if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬ØŸ')) {
    await supabase.auth.signOut();
    showError();
  }
});

// Ø§Ù„ØªØ­Ù‚Ù‚ Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
document.addEventListener('DOMContentLoaded', async () => {
  await checkSession();
});

// Ø§Ù„Ø­Ù…Ø§ÙŠØ© Ø¶Ø¯ Ø§Ù„Ø±Ø¬ÙˆØ¹ Ø£Ùˆ Ø§Ù„ÙƒØ§Ø´
window.addEventListener('pageshow', function(event) {
  if (event.persisted) {
    checkSession();
  }
});
history.pushState(null, null, location.href);
window.onpopstate = function () { history.go(1); };
</script>
</body>
</html>
