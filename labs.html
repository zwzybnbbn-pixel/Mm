<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø®ØªØ¨Ø±Ø§Øª</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;800&display=swap" rel="stylesheet">

<style>
  *{margin:0;padding:0;box-sizing:border-box;font-family:'Cairo',sans-serif;}
  body{background:#eef3f3;display:flex;justify-content:center;}
  .container{width:100%;max-width:380px;padding:15px;}

  .back-btn{display:inline-block;background:#444;color:white;padding:8px 14px;border-radius:10px;text-decoration:none;margin-bottom:12px;}
  h1{text-align:center;color:#00695C;margin-bottom:10px;font-size:24px;font-weight:800;}

  .search-box{width:100%;padding:10px;border-radius:10px;border:1px solid #bbb;margin-bottom:15px;font-size:15px;}

  .card{background:white;padding:16px;border-radius:14px;margin-bottom:14px;box-shadow:0 3px 10px rgba(0,0,0,0.10);transition:0.2s;}
  .card:hover{transform:translateY(-3px);}
  
  .img{width:90px;height:90px;border-radius:50%;object-fit:cover;margin:0 auto 10px auto;border:3px solid #009688;display:block;}
  .title{font-size:19px;font-weight:800;text-align:center;color:#00695C;margin-bottom:10px;}
  .info{text-align:center;font-size:15px;margin-bottom:4px;color:#333;}

  .btn{display:block;width:100%;padding:10px;margin-top:10px;background:#00796B;color:white;text-align:center;font-size:15px;border-radius:10px;text-decoration:none;}
</style>
</head>

<body>

<div class="container">

  <a href="branches.html" class="back-btn">â¬… Ø±Ø¬ÙˆØ¹</a>

  <h1>ğŸ§ª Ø§Ù„Ù…Ø®ØªØ¨Ø±Ø§Øª</h1>

  <input id="search" type="text" class="search-box" placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù† Ù…Ø®ØªØ¨Ø±...">

  <div id="labs">Ø¬Ø§Ø± Ø§Ù„ØªØ­Ù…ÙŠÙ„...</div>

</div>

<script type="module">
  import { db } from "./firebase-config.js";
  import { collection, getDocs }
  from "https://www.gstatic.com/firebasejs/12.6.0/firebase-firestore.js";

  let allLabs = [];

  async function loadLabs(){
    const snap = await getDocs(collection(db,"labs"));
    const box = document.getElementById("labs");
    box.innerHTML = "";
    allLabs = [];

    snap.forEach(doc => allLabs.push({ id: doc.id, ...doc.data() }));
    render(allLabs);
  }

  function render(list){
    const box = document.getElementById("labs");
    box.innerHTML = "";

    if(list.length === 0){
      box.innerHTML = "<p style='text-align:center;color:#777;'>Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬</p>";
      return;
    }

    list.forEach(l=>{
      box.innerHTML += `
        <div class="card">
          <img class="img" src="${l.img || 'https://i.postimg.cc/TPZpYH5f/noimage.png'}">
          <div class="title">${l.name}</div>
          <p class="info"><b>Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©:</b> ${l.city || "ØºÙŠØ± Ù…Ø­Ø¯Ø¯"}</p>
          <p class="info"><b>Ø§Ù„Ù‡Ø§ØªÙ:</b> ${l.phone || "Ù„Ø§ ÙŠÙˆØ¬Ø¯"}</p>
          <a class="btn" href="lab.html?id=${l.id}">Ø¹Ø±Ø¶ Ø§Ù„ØªÙØ§ØµÙŠÙ„</a>
        </div>
      `;
    });
  }

  document.getElementById("search").addEventListener("input", e=>{
    const q = e.target.value;
    render(allLabs.filter(l => l.name.includes(q)));
  });

  loadLabs();
</script>

</body>
</html>