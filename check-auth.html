<!DOCTYPE html>
<html>
<head>
<title>ÙØ­Øµ Ø­Ø§Ù„Ø© Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©</title>
<style>
body { font-family: Arial; padding: 20px; }
pre { background: #f5f5f5; padding: 15px; border-radius: 5px; }
.button { background: #007bff; color: white; padding: 10px 15px; border: none; border-radius: 5px; cursor: pointer; margin: 5px; }
</style>
</head>
<body>
<h2>ğŸ” ÙØ­Øµ Ø­Ø§Ù„Ø© Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©</h2>
<button class="button" onclick="checkAuth()">ÙØ­Øµ localStorage</button>
<button class="button" onclick="clearAll()">Ù…Ø³Ø­ Ø§Ù„ÙƒÙ„</button>
<button class="button" onclick="window.location.href='login1.html'">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</button>
<button class="button" onclick="window.location.href='dashboard2.html'">Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</button>
<hr>
<div id="result"></div>

<script>
async function checkAuth() {
  const keys = [
    'login1_authenticated',
    'login1_auth_token', 
    'login1_timeout',
    'login1_user_data',
    'supabase_session'
  ];
  
  let result = '<h3>ğŸ”‘ Ø­Ø§Ù„Ø© localStorage:</h3>';
  
  keys.forEach(key => {
    const value = localStorage.getItem(key);
    const exists = value !== null;
    
    result += `<div style="margin: 10px 0; padding: 10px; background: ${exists ? '#d4edda' : '#f8d7da'}; border-radius: 5px;">`;
    result += `<strong>${key}:</strong> ${exists ? 'âœ… Ù…ÙˆØ¬ÙˆØ¯' : 'âŒ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯'}<br>`;
    
    if (exists) {
      try {
        const parsed = JSON.parse(value);
        if (key === 'login1_timeout') {
          const date = new Date(parseInt(value));
          const now = new Date();
          const expired = date < now;
          result += `Ø§Ù„Ù‚ÙŠÙ…Ø©: ${date.toLocaleString('ar-SA')}<br>`;
          result += `Ø§Ù„Ø­Ø§Ù„Ø©: ${expired ? 'âŒ Ù…Ù†ØªÙ‡ÙŠØ©' : 'âœ… Ø³Ø§Ø±ÙŠØ©'}<br>`;
        } else {
          result += `Ø§Ù„Ù‚ÙŠÙ…Ø©: ${JSON.stringify(parsed)}<br>`;
        }
      } catch {
        result += `Ø§Ù„Ù‚ÙŠÙ…Ø©: ${value}<br>`;
      }
    }
    
    result += '</div>';
  });
  
  // ÙØ­Øµ ØµÙ„Ø§Ø­ÙŠØ© Ø§Ù„Ø¬Ù„Ø³Ø©
  const timeout = localStorage.getItem('login1_timeout');
  if (timeout) {
    const now = new Date().getTime();
    const expiry = parseInt(timeout);
    const isValid = now < expiry;
    
    result += `<div style="margin: 20px 0; padding: 15px; background: ${isValid ? '#d4edda' : '#f8d7da'}; border-radius: 5px;">`;
    result += `<h4>ğŸ” Ø­Ø§Ù„Ø© Ø§Ù„Ø¬Ù„Ø³Ø©:</h4>`;
    result += `Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ø­Ø§Ù„ÙŠ: ${new Date(now).toLocaleString('ar-SA')}<br>`;
    result += `ÙˆÙ‚Øª Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡: ${new Date(expiry).toLocaleString('ar-SA')}<br>`;
    result += `Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ: ${Math.max(0, Math.round((expiry - now) / 1000 / 60))} Ø¯Ù‚ÙŠÙ‚Ø©<br>`;
    result += `<strong>Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©: ${isValid ? 'âœ… Ø¬Ù„Ø³Ø© ØµØ§Ù„Ø­Ø©' : 'âŒ Ø¬Ù„Ø³Ø© Ù…Ù†ØªÙ‡ÙŠØ©'}</strong>`;
    result += '</div>';
  }
  
  document.getElementById('result').innerHTML = result;
}

function clearAll() {
  if (confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¬Ù„Ø³Ø©ØŸ')) {
    localStorage.clear();
    alert('ØªÙ… Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª');
    checkAuth();
  }
}

// ÙØ­Øµ ØªÙ„Ù‚Ø§Ø¦ÙŠ Ø¹Ù†Ø¯ Ø§Ù„ØªØ­Ù…ÙŠÙ„
checkAuth();
</script>
</body>
</html>